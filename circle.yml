dependencies:
  cache_directories:
    - ~/.yarn-cache
  override:
    - case $CIRCLE_NODE_INDEX in 0) make setup ;; 1) nvm install 6 && nvm exec 6 make setup ;; 2) nvm install 7 && nvm exec 7 make setup ;; esac:
        parallel: true
  pre:
    - sudo apt-key adv --keyserver pgp.mit.edu --recv D101F7899D41F3C3
    - echo 'deb http://dl.yarnpkg.com/debian/ stable main' | sudo tee /etc/apt/sources.list.d/yarn.list
    - sudo apt-get update -qq
    - sudo apt-get install -y -qq yarn

machine:
  node:
    version: 4

test:
  override:
    - make lint
    - case $CIRCLE_NODE_INDEX in 0) make test ;; 1) nvm exec 6 make test ;; 2) nvm exec 7 make test ;; esac:
        parallel: true
    - node_modules/.bin/karma start
